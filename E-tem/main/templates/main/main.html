{% extends 'base.html' %}
{% load static %}

{% block content %}
    <head>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}">
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Lemonada:wght@700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Do+Hyeon&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Song+Myung&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Gothic+A1:wght@500;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@700&display=swap" rel="stylesheet">
    </head>

    <body>
    <main role="main">
        {% if user.is_authenticated %}
        {% else %}
            <div class="before_login_main">
                <div class="big-text"><h1 class="display-2 pb-2"><span style="color: lightcoral">E</span>very <span
                        style="color: lightcoral">Tem</span>plate
                </h1>
                    <button type="button" class="login_button">
                        <a href="{% url 'loginhome' %}" style="text-decoration: none;color:black; ">DOWNLOAD NOW </a>
                    </button>
                </div>
                <img class="main_background_img"
                     src="https://post-phinf.pstatic.net/MjAyMDA0MjNfOCAg/MDAxNTg3NTg0NTY3Njky.FKxKOXFG7nIlVX9NDikM057o-xa2TfPeHYJ1NUO8wmIg.k2-yQEgz6k4lTXzbYZcI4b9zw8w3a09MprgGGBz08Ekg.JPEG/GettyImages-1194254554.jpg?type=w1200"/>
            </div>
        {% endif %}


        {% if not user.is_authenticated %}
            <div class="show_top">
            {% block head_show %}
                <head>
                    <link rel="stylesheet" type="text/css" href="{% static 'css/head_show.css' %}">
                </head>
                <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
                <link href='https://fonts.googleapis.com/css?family=Anton' rel='stylesheet' type='text/css'>
                <link href='https://fonts.googleapis.com/css?family=Neucha' rel='stylesheet' type='text/css'>

                <div class="top5_ppt_text"><h1>ì „ì²´ ì¸ê¸° í…œí”Œë¦¿ <span style="color: lightcoral">TOP 5</span></h1></div>
                {% if not user.is_authenticated %}
                    <div class="wrapper" style="pointer-events: none;">
                {% else %}
                    <div class="wrapper">
                {% endif %}
            <div id="slider-wrap" class="top5_ppt">
                <ul id="slider" class="top5_ppt">

                    {% for template in top5_template %}
                        <li>
                            <img src={{ template.img_src }}>
                            <div class="btn-group">
                                <button type="button" class="btn btn-lg btn-secondary">
                                    <a data-id="{{ template.id }}" class="add_to_cart">ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸°</a>
                                </button>
                                <button type="button" class="btn btn-lg btn-secondary">
                                    <a href="{% url 'add_one_to_download_list' template.id %}"
                                       name="download"
                                       style="color: white">ê°œë³„ ë‹¤ìš´ë¡œë“œ</a>
                                </button>
                            </div>
                        </li>

                    {% endfor %}
                </ul>

                <!--controls-->
                <div class="btns" id="next"><i class="fa fa-arrow-right"></i></div>
                <div class="btns" id="previous"><i class="fa fa-arrow-left"></i></div>
                <div id="counter"></div>

                <div id="pagination-wrap">
                    <ul>
                    </ul>
                </div>
                <!--controls-->
            </div>
            </div>
            {% endblock %}
        </div>
        {% endif %}

        {% if not user.is_authenticated %}
            <div class="etem_description"><p class="etem_description_p"><br>" ë°œí‘œì¤€ë¹„ í•  ë•Œ PPT ë§Œë“œëŠë¼ ì‹œê°„ ë‹¤ ì“°ëŠ” ë‹¹ì‹ , ì˜ˆìœ PPTë¥¼ ë¬´ë£Œë¡œ
                ë‹¤ìš´
                ë°›ì•„ë³´ì„¸ìš”! "</p></div>
        {% endif %}

        {% if user.is_authenticated %}
            <main role="main">
                <section class=" text-center">
                    <div class="container">
                        <h3>ì›í•˜ëŠ” ìƒ‰ì„ ì„ íƒí•˜ê³  ë§˜ì— ë“œëŠ” í…œí”Œë¦¿ì„ ê³¨ë¼ë³´ì„¸ìš”</h3>
                    </div>
                </section>
            </main>
            <div class="color_select ">

                <a href="{% url 'color' 6 %}">ğŸ–¤</a>
                <a href="{% url 'color' 5 %}">ğŸ¤</a>
                <a href="{% url 'color' 3 %}">â¤ï¸</a>
                <a href="{% url 'color' 8 %}">ğŸ§¡</a>
                <a href="{% url 'color' 4 %}">ğŸ’›</a>
                <a href="{% url 'color' 2 %}">ğŸ’š</a>
                <a href="{% url 'color' 1 %}">ğŸ’™</a>
                <a href="{% url 'color' 7 %}">ğŸ’œ</a>
                <a href="{% url 'color' 9 %}">ğŸ’—</a>
                <a href="{% url 'color' 11 %}">ğŸ¤</a>
                <a href="{% url 'color' 12 %}">ğŸŒª</a>
                <a href="{% url 'color' 10 %}">&#127752;</a>
            </div>
            <div style="position: relative; float: right; width: 80px; height: 80px">
                <div id="cartscroll" style="position:absolute;top:0px;right: 5%; z-index: 999">
                    <a href="{% url 'cart' %}">
                        <img src="https://icon-library.net/images/free-shopping-cart-icon/free-shopping-cart-icon-3.jpg"
                             style="width: 80px; height: 80px; border-radius: 50%; "/>
                    </a>
                </div>
            </div>
        {% endif %}

        <div class="album py-5 bg-light">
            <div class="album py-5 bg-light">
                <div class="container">

                    {% if user.is_authenticated %}
                    {% else %}
                        <div class="previews_text"><span style="color: lightcoral"> E-tem</span> ì´ ì œê³µí•˜ëŠ” í…œí”Œë¦¿ ë¯¸ë¦¬ë³´ê¸°</div>
                    {% endif %}

                    <div class="row">
                        {% for ppt in template_list %}
                            <div class="col-lg-4" style="overflow: hidden">
                                <div class="card mb-4 shadow-sm col-lg-12"
                                     style="text-align: center; text-decoration: none">

                                    {% if not user.is_authenticated %}
                                        <img class="ppt_img" style="pointer-events: none;"
                                             src={{ ppt.img_src }} height="200vh" width="350vw">
                                    {% else %}
                                        <a href="{{ ppt.detail_page }}" target="_blank"
                                           style="text-decoration: none; color:black">
                                        <img class="ppt_img" src={{ ppt.img_src }} height="200vh" width="350vw">
                                        <p class="img_text" style="margin-top: -40px"><strong>View Page</strong></p>
                                    {% endif %}

                                    </a>

                                    {% if user.is_authenticated %}
                                        <div class="btn-group " style=" justify-content: space-around; margin: 10px 0">
                                            <button type="button" class="btn btn-sm btn-outline-secondary ">
                                                <a data-id="{{ ppt.id }}" class="add_to_cart">ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸°</a>
                                            </button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary">
                                                <a href="{% url 'add_one_to_download_list' ppt.id %}" name="download">ê°œë³„
                                                    ë‹¤ìš´ë¡œë“œ</a>
                                            </button>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        {% endfor %}
                    </div>


                    <!--pagination-->
                    <div class="pagination ">
                        <span class="d-flex ">
                            {% if template_list.has_previous %}
                                <li class="page-item"><a href="?page=1" class="page-link"  style="color: lightcoral">&laquo; ì²« í˜ì´ì§€</a></li>
                            {% endif %}

                            {% if template_list.number > 5 %}
                                <li class="page-item"><a href="?page={{ previous_block }}"
                                                          class="page-link"  style="color: lightcoral">ì´ì „</a></li>
                            {% endif %}

                            {% for i in p_range %}
                                {% if template_list.number == i %}
                                    <li class="page-item active"><a href="?page={{ i }}"
                                                                    class="page-link" style="background-color: lightcoral; color: white; border-color: lightcoral">{{ i }}</a></li>
                                {% else %}
                                    <li class="page-item "><a href="?page={{ i }}" class="page-link" style="color: lightcoral">{{ i }}</a></li>
                                {% endif %}
                            {% endfor %}

                            {% if template_list.number < template_list.paginator.num_pages %}
                                <li class="page-item "><a href="?page={{ next_block }}" class="page-link"  style="color: lightcoral">ë‹¤ìŒ</a></li>
                            {% endif %}
                            {% if template_list.has_next %}
                                <li class="page-item "><a href="?page={{ template_list.paginator.num_pages }}"
                                                          class="page-link"  style="color: lightcoral">ë§ˆì§€ë§‰ í˜ì´ì§€ &raquo;</a></li>
                            {% endif %}
                        </span>
                    </div>
                </div>
            </div>
        </div>

    </main>

    </body>

    <!--ì—¬ê¸°ì— ajaxë¡œ ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸°-->
    <script>

        $(document).ready(function () {
            $('.add_to_cart').on('click', function () {
                const templateId = $(this).attr('data-id')
                $.ajax({
                    type: 'GET',
                    url: `/add/${templateId}`,
                    data: templateId,
                    dataType: "json",
                    success: function (data) {
                        alert("ë‹´ê²¼ìŠµë‹ˆë‹¤.");
                    },
                    error: function (data) {
                        alert('ì•ˆë‹´ê¹€')
                    }
                })
            })
        });

    </script>

    <script>
        $(window).scroll(function () {
            $('#cartscroll').animate({top: $(window).scrollTop() + "px"}, {queue: false, duration: 100});
        });

    </script>

    <script>
        //current position
        var pos = 0;
        //number of slides
        var totalSlides = $('#slider-wrap ul li').length;
        //get the slide width
        var sliderWidth = $('#slider-wrap').width();


        $(document).ready(function () {


            /*****************
             BUILD THE SLIDER
             *****************/
            //set width to be 'x' times the number of slides
            $('#slider-wrap ul#slider').width(sliderWidth * totalSlides);

            //next slide
            $('#next').click(function () {
                slideRight();
            });

            //previous slide
            $('#previous').click(function () {
                slideLeft();
            });


            /*************************
             //*> OPTIONAL SETTINGS
             ************************/
                //automatic slider
            var autoSlider = setInterval(slideRight, 3000);

            //for each slide
            $.each($('#slider-wrap ul li'), function () {

                //create a pagination
                var li = document.createElement('li');
                $('#pagination-wrap ul').append(li);
            });

            //counter
            countSlides();

            //pagination
            pagination();

            //hide/show controls/btns when hover
            //pause automatic slide when hover
            $('#slider-wrap').hover(
                function () {
                    $(this).addClass('active');
                    clearInterval(autoSlider);
                },
                function () {
                    $(this).removeClass('active');
                    autoSlider = setInterval(slideRight, 3000);
                }
            );


        });//DOCUMENT READY


        /***********
         SLIDE LEFT
         ************/
        function slideLeft() {
            pos--;
            if (pos == -1) {
                pos = totalSlides - 1;
            }
            $('#slider-wrap ul#slider').css('left', -(sliderWidth * pos));

            //*> optional
            countSlides();
            pagination();
        }


        /************
         SLIDE RIGHT
         *************/
        function slideRight() {
            pos++;
            if (pos == totalSlides) {
                pos = 0;
            }
            $('#slider-wrap ul#slider').css('left', -(sliderWidth * pos));

            //*> optional
            countSlides();
            pagination();
        }


        /************************
         //*> OPTIONAL SETTINGS
         ************************/
        function countSlides() {
            $('#counter').html(pos + 1 + ' / ' + totalSlides);
            document.getElementById("counter").style.color = "black";
        }

        function pagination() {
            $('#pagination-wrap ul li').removeClass('active');
            $('#pagination-wrap ul li:eq(' + pos + ')').addClass('active');
        }


    </script>
{% endblock %}